/*! For license information please see messages.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5871],{90562:(t,e,n)=>{n.r(e),n.d(e,{default:()=>d});function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function o(){var t=u(),e=t.m(o),n=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function a(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===n||"GeneratorFunction"===(e.displayName||e.name))}var p={throw:1,return:2,break:3,continue:3};function g(t){var e,n;return function(a){e||(e={stop:function(){return n(a.a,2)},catch:function(){return a.v},abrupt:function(t,e){return n(a.a,p[t],e)},delegateYield:function(t,o,i){return e.resultName=o,n(a.d,r(t),i)},finish:function(t){return n(a.f,t)}},n=function(t,n,o){a.p=e.prev,a.n=e.next;try{return t(n,o)}finally{e.next=a.n}}),e.resultName&&(e[e.resultName]=a.v,e.resultName=void 0),e.sent=a.v,e.next=a.n;try{return t.call(this,e)}finally{a.p=e.prev,a.n=e.next}}}return(o=function(){return{wrap:function(e,n,a,o){return t.w(g(e),n,a,o&&o.reverse())},isGeneratorFunction:a,mark:t.m,awrap:function(t,e){return new _(t,e)},AsyncIterator:l,async:function(t,e,n,o,r){return(a(e)?c:s)(g(t),e,n,o,r)},keys:i,values:r}})()}function r(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}throw new TypeError(a(t)+" is not iterable")}function i(t){var e=Object(t),n=[];for(var a in e)n.unshift(a);return function t(){for(;n.length;)if((a=n.pop())in e)return t.value=a,t.done=!1,t;return t.done=!0,t}}function s(t,e,n,a,o){var r=c(t,e,n,a,o);return r.next().then((function(t){return t.done?t.value:r.next()}))}function c(t,e,n,a,o){return new l(u().w(t,e,n,a),o||Promise)}function l(t,e){function n(a,o,r,i){try{var s=t[a](o),c=s.value;return c instanceof _?e.resolve(c.v).then((function(t){n("next",t,r,i)}),(function(t){n("throw",t,r,i)})):e.resolve(c).then((function(t){s.value=t,r(s)}),(function(t){return n("throw",t,r,i)}))}catch(t){i(t)}}var a;this.next||(p(l.prototype),p(l.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),p(this,"_invoke",(function(t,o,r){function i(){return new e((function(e,a){n(t,r,e,a)}))}return a=a?a.then(i,i):i()}),!0)}function u(){var t,e,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function r(n,a,o,r){var c=a&&a.prototype instanceof s?a:s,l=Object.create(c.prototype);return p(l,"_invoke",function(n,a,o){var r,s,c,l=0,u=o||[],p=!1,_={p:0,n:0,v:t,a:g,f:g.bind(t,4),d:function(e,n){return r=e,s=0,c=t,_.n=n,i}};function g(n,a){for(s=n,c=a,e=0;!p&&l&&!o&&e<u.length;e++){var o,r=u[e],g=_.p,f=r[2];n>3?(o=f===a)&&(c=r[(s=r[4])?5:(s=3,3)],r[4]=r[5]=t):r[0]<=g&&((o=n<2&&g<r[1])?(s=0,_.v=a,_.n=r[1]):g<f&&(o=n<3||r[0]>a||a>f)&&(r[4]=n,r[5]=a,_.n=f,s=0))}if(o||n>1)return i;throw p=!0,a}return function(o,u,f){if(l>1)throw TypeError("Generator is already running");for(p&&1===u&&g(u,f),s=u,c=f;(e=s<2?t:c)||!p;){r||(s?s<3?(s>1&&(_.n=-1),g(s,c)):_.n=c:_.v=c);try{if(l=2,r){if(s||(o="next"),e=r[o]){if(!(e=e.call(r,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=r.return)&&e.call(r),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);r=t}else if((e=(p=_.n<0)?c:n.call(a,_))!==i)break}catch(e){r=t,s=1,c=e}finally{l=1}}return{value:e,done:p}}}(n,o,r),!0),l}var i={};function s(){}function c(){}function l(){}e=Object.getPrototypeOf;var _=[][a]?e(e([][a]())):(p(e={},a,(function(){return this})),e),g=l.prototype=s.prototype=Object.create(_);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,p(t,o,"GeneratorFunction")),t.prototype=Object.create(g),t}return c.prototype=l,p(g,"constructor",l),p(l,"constructor",c),c.displayName="GeneratorFunction",p(l,o,"GeneratorFunction"),p(g),p(g,o,"Generator"),p(g,a,(function(){return this})),p(g,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:r,m:f}})()}function p(t,e,n,a){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}p=function(t,e,n,a){function r(e,n){p(t,e,(function(t){return this._invoke(e,n,t)}))}e?o?o(t,e,{value:n,enumerable:!a,configurable:!a,writable:!a}):t[e]=n:(r("next",0),r("throw",1),r("return",2))},p(t,e,n,a)}function _(t,e){this.v=t,this.k=e}function g(t,e,n,a,o,r,i){try{var s=t[r](i),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,o)}const f={name:"Messages",components:{BktCardImageCategory:n(63887).A},data:function(){return{info_categories:[{id:1,code:"platform",title:"сообщения платформы",color:"green"},{id:2,code:"favourite",title:"избранное",color:"yellow"},{id:3,code:"monitoring",title:"мониторинг",color:"red"}],selectedType:"all",type_loading:!1,signal:null,controller:null}},created:function(){var t=1;sessionStorage.getItem("messages_page")&&(t=sessionStorage.getItem("messages_page")),this.getData(t)},computed:{items:function(){return this.$store.getters.notifications},pagination_data:function(){return this.$store.getters.notifications_pagination},loading:function(){return this.$store.getters.notifications_loading},notifications_count:function(){return this.$store.getters.notifications_count}},methods:{getData:function(){var t,e=arguments,n=this;return(t=o().mark((function t(){var a,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:1,n.controller=new AbortController,n.signal=n.controller.signal,r=n.selectedType,sessionStorage.getItem("messages_page_type")&&(r=sessionStorage.getItem("messages_page_type"))!=n.selectedType&&(n.selectedType=r),sessionStorage.setItem("messages_page",a+""),t.next=8,n.$store.dispatch("getNotifications",{page:a,type:r,signal:n.signal});case 8:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(a,o){var r=t.apply(e,n);function i(t){g(r,a,o,i,s,"next",t)}function s(t){g(r,a,o,i,s,"throw",t)}i(void 0)}))})()},setType:function(t){var e=this;this.signal&&this.controller.abort(),this.type_loading=!0,this.selectedType=t,sessionStorage.setItem("messages_page_type",t),setTimeout((function(){e.getData(1).then((function(t){e.type_loading=!1})).catch((function(t){e.type_loading=!1}))}),50)},changePage:function(t){var e=this;this.signal&&this.controller.abort(),setTimeout((function(){e.getData(t).then((function(){var t=e.$refs.cardList;t&&requestAnimationFrame((function(){t.scrollIntoView({block:"start",scrollBehavior:"smooth"}),requestAnimationFrame((function(){t.scrollIntoView()}))}))}))}),50)},navigate:function(t){"monitoring"===t.type&&(sessionStorage.setItem("monitoring_path_id",t.dataMonitoring.folderInfo.pathId),sessionStorage.setItem("monitoring"+t.dataMonitoring.folderInfo.pathId+"_page","1"),this.$router.push("/monitoring")),"favourite"===t.type&&this.$router.push("/lot/"+t.dataFavourite.id)}}};const d=(0,n(14486).A)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"bkt-messages bkt-page bkt-container"},[e("h1",{staticClass:"bkt-page__title"},[t._v("\n        Сообщения\n    ")]),t._v(" "),e("div",{staticClass:"bkt-content"},[e("div",{ref:"cardList",staticClass:"row"},[e("div",{staticClass:"col-12 col-lg-3"},[e("div",{staticClass:"bkt-history__chats"},[e("ul",{staticClass:"list-unstyled text-left pt-4 pb-4"},[e("li",{staticClass:"bkt-chat",class:{"bkt-bg-primary-lighter":"all"==t.selectedType},attrs:{id:"chat-1"},on:{click:function(e){return t.setType("all")}}},[t._v("\n                            Все\n                            "),e("div",{staticClass:"bkt-chat__num rounded-pill bkt-bg-primary bkt-text-neutral-light"},[t.notifications_count.all>0?e("span",{staticClass:"p-2"},[t._v("\n                                    "+t._s(t.notifications_count.all)+"\n                                ")]):t._e()])]),t._v(" "),e("li",{staticClass:"bkt-chat",class:{"bkt-bg-green-lighter":"platform"==t.selectedType},attrs:{id:"chat-2"},on:{click:function(e){return t.setType("platform")}}},[e("div",{staticClass:"bkt-chat__text"},[e("bkt-icon",{attrs:{name:"Bell",color:"green",width:"15px",height:"15px"}}),t._v("\n                                Сообщения платформы\n                            ")],1),t._v(" "),e("div",{staticClass:"bkt-chat__num rounded-pill bkt-bg-green bkt-text-neutral-light"},[t.notifications_count.platform>0?e("span",{staticClass:"p-2"},[t._v("\n                                    "+t._s(t.notifications_count.platform)+"\n                                ")]):t._e()])]),t._v(" "),e("li",{staticClass:"bkt-chat",class:{"bkt-bg-yellow-lighter":"favourite"==t.selectedType},attrs:{id:"chat-3"},on:{click:function(e){return t.setType("favourite")}}},[e("div",{staticClass:"bkt-chat__text"},[e("bkt-icon",{attrs:{name:"Star",color:"yellow",width:"15px",height:"15px"}}),t._v("\n                                Избранное\n                            ")],1),t._v(" "),e("div",{staticClass:"bkt-chat__num rounded-pill bkt-bg-yellow bkt-text-neutral-light"},[t.notifications_count.favourite>0?e("span",{staticClass:"p-2"},[t._v("\n                                    "+t._s(t.notifications_count.favourite)+"\n                                ")]):t._e()])]),t._v(" "),e("li",{staticClass:"bkt-chat",class:{"bkt-bg-red-lighter":"monitoring"==t.selectedType},attrs:{id:"chat-4"},on:{click:function(e){return t.setType("monitoring")}}},[e("div",{staticClass:"bkt-chat__text"},[e("bkt-icon",{attrs:{name:"Target",color:"red",width:"15px",height:"15px"}}),t._v("\n                                Мониторинг\n                            ")],1),t._v(" "),e("div",{staticClass:"rounded-pill bkt-bg-red bkt-text-neutral-light"},[t.notifications_count.monitoring>0?e("span",{staticClass:"p-2"},[t._v("\n                                    "+t._s(t.notifications_count.monitoring)+"\n                                ")]):t._e()])])])])]),t._v(" "),e("div",{staticClass:"col-12 col-lg-9 bkt-gap-row-medium"},[e("div",{staticClass:"bkt-wrapper-column bkt-gap-row-medium"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.loading,expression:"!loading"}],staticClass:"bkt-wrapper-column bkt-gap-mini"},t._l(t.items,(function(n,a){return n?e("div",{key:a,staticClass:"bkt-message",class:{"bkt-cursor-pointer":"platform"!==n.type},on:{click:function(e){return t.navigate(n)}}},[e("bkt-icon",{staticClass:"bkt-message__check",attrs:{name:"Check",color:n.isSeen?"primary":"main-lighter",width:"15px",height:"15px"}}),t._v(" "),e("div",{staticClass:"d-md-none bkt-wrapper-between w-100"},[e("h6",{staticClass:"bkt-message__date"},[t._v("\n                                    "+t._s(t._f("moment")(n.date,"D MMMM YYYY"))+" в "+t._s(t._f("moment")(n.date,"HH:mm"))+"\n                                ")]),t._v(" "),e("div",{staticClass:"bkt-chat-content__info text-right"},[e("div",{staticClass:"bkt-message__type",class:{"bkt-bg-red-lighter bkt-text-red":"monitoring"==n.type,"bkt-bg-yellow-lighter bkt-text-yellow":"favourite"==n.type,"bkt-bg-green-lighter bkt-text-green":"platform"==n.type}},[t._v("\n                                        "+t._s("monitoring"==n.type?"мониторинг":"")+"\n                                        "+t._s("favourite"==n.type?"избранное":"")+"\n                                        "+t._s("platform"==n.type?"сообщения платформы":"")+"\n                                    ")])])]),t._v(" "),e("div",{staticClass:"bkt-wrapper-column bkt-message__content"},[e("div",{staticClass:"bkt-wrapper bkt-nowrap me-auto ms-0"},["favourite"==n.type?e("div",{staticClass:"bkt-message__image-wrapper"},[(!n.dataFavourite.photos||0==n.dataFavourite.photos.length)&&n.dataFavourite.categories&&n.dataFavourite.categories.length>0?e("bkt-card-image-category",{attrs:{no_multiple:!0,categories:n.dataFavourite.categories}}):t._e(),t._v(" "),n.dataFavourite.photos&&n.dataFavourite.photos.length>0?e("img",{staticClass:"bkt-message__image",attrs:{src:n.dataFavourite.photos[0].preview,alt:""}}):t._e()],1):t._e(),t._v(" "),e("div",{staticClass:"bkt-chat-content__text"},["monitoring"==n.type&&n.dataMonitoring?e("div",{staticClass:"bkt-badge mx-0 mb-2",class:n.dataMonitoring.folderInfo.color?"bkt-bg-"+n.dataMonitoring.folderInfo.color:"bkt-bg-primary"},[t._v("\n                                            "+t._s(n.dataMonitoring.folderInfo.name)+"\n                                        ")]):t._e(),t._v(" "),"monitoring"==n.type?e("h5",{staticClass:"bkt-message__text bkt-cursor-pointer"},[t._v("\n                                            Появились новые лоты в мониторинге:\n                                            "+t._s(n.dataMonitoring?n.dataMonitoring.newLotCount:"0")+"\n                                        ")]):t._e(),t._v(" "),"platform"==n.type&&n.dataPlatform?e("h6",{staticClass:"bkt-message__title"},[t._v("\n                                            "+t._s(n.dataPlatform.label)+"\n                                        ")]):t._e(),t._v(" "),"platform"==n.type?e("h5",{staticClass:"bkt-message__text"},[t._v("\n                                            "+t._s(n.dataPlatform?n.dataPlatform.value:"")+"\n                                        ")]):t._e(),t._v(" "),"favourite"==n.type&&n.dataFavourite?e("h6",{staticClass:"bkt-message__title bkt-card__title bkt-text-truncate bkt-arrow-after bkt-cursor-pointer"},[t._v("\n                                            "+t._s(n.dataFavourite.description)+"\n                                        ")]):t._e(),t._v(" "),"favourite"==n.type?e("h5",{staticClass:"bkt-message__text"},[t._v("\n                                            "+t._s(n.dataFavourite?n.dataFavourite.detail:"")+"\n                                        ")]):t._e()])]),t._v(" "),e("h6",{staticClass:"d-none d-md-block bkt-message__date"},[t._v("\n                                    "+t._s(t._f("moment")(n.date,"D MMMM YYYY"))+" в "+t._s(t._f("moment")(n.date,"HH:mm"))+"\n                                ")])]),t._v(" "),e("div",{staticClass:"bkt-message__type d-none d-md-block",class:{"bkt-bg-red-lighter bkt-text-red":"monitoring"==n.type,"bkt-bg-yellow-lighter bkt-text-yellow":"favourite"==n.type,"bkt-bg-green-lighter bkt-text-green":"platform"==n.type}},[t._v("\n                                "+t._s("monitoring"==n.type?"мониторинг":"")+"\n                                "+t._s("favourite"==n.type?"избранное":"")+"\n                                "+t._s("platform"==n.type?"сообщения платформы":"")+"\n                            ")])],1):t._e()})),0),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading||t.type_loading,expression:"loading||type_loading"}],staticClass:"bkt-wrapper-column bkt-gap-mini"},t._l(20,(function(n,a){return e("div",{key:a,staticClass:"bkt-message"},[e("skeleton",{attrs:{width:"15px",height:"15px",skeleton_class:"bkt-message__check"}}),t._v(" "),e("div",{staticClass:"d-md-none bkt-wrapper-between w-100"},[e("skeleton",{attrs:{skeleton_class:"bkt-message__date mb-1",height:"12px"}}),t._v(" "),e("div",{staticClass:"bkt-chat-content__info text-right"},[e("skeleton",{attrs:{skeleton_class:"bkt-bkt-message__type",width:"92px"}})],1)],1),t._v(" "),e("div",{staticClass:"bkt-wrapper-column bkt-message__content"},[e("div",{staticClass:"bkt-wrapper bkt-nowrap me-auto ms-0"},[e("div",{staticClass:"bkt-message__image-wrapper"},[e("skeleton",{attrs:{skeleton_class:"bkt-message__image"}})],1),t._v(" "),e("div",{staticClass:"bkt-chat-content__text"},[e("skeleton",{attrs:{height:"14px",width:"150px",skeleton_class:"mb-1"}}),t._v(" "),e("skeleton",{attrs:{height:"12px",width:"60%"}})],1)]),t._v(" "),e("skeleton",{attrs:{height:"12px",skeleton_class:"d-none d-md-block bkt-message__date"}})],1),t._v(" "),e("skeleton",{attrs:{skeleton_class:"bkt-message__type d-none d-md-block",width:"92px"}})],1)})),0),t._v(" "),t.pagination_data&&!t.type_loading?e("bkt-pagination",{attrs:{limit:1,data:t.pagination_data,extraControls:!1},on:{"change-page":t.changePage}}):t._e()],1)])])])])}),[],!1,null,"8c0212ba",null).exports}}]);
//# sourceMappingURL=messages.js.map