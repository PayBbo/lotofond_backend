{"version":3,"file":"js/bot-tariffs.js","mappings":"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","sources":["webpack:///resources/js/bot/TariffPage.vue","webpack:///./resources/js/bot/TariffPage.vue?5cd8","webpack:///./resources/js/bot/TariffPage.vue?e059","webpack:///./resources/js/bot/TariffPage.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"bkt-page bkt-container bkt-tariffs\">\n<!--            <div class=\"bkt-shadow-card bkt-shadow-card_primary mt-3 mb-4\">-->\n<!--                <div class=\"bkt-shadow-card__inner bkt-gap-large\">-->\n<!--                    <h4 class=\"bkt-shadow-card__title bkt-text-white\">-->\n<!--                        Пробный период закончился<br>-->\n<!--                        <span>Купите подписку, чтобы продолжить просмотр лотов</span>-->\n<!--                    </h4>-->\n<!--                    <div class=\"bkt-shadow-card__shadow-1\">-->\n<!--                    </div>-->\n<!--                    <div class=\"bkt-shadow-card__shadow-2\">-->\n<!--                    </div>-->\n<!--                </div>-->\n<!--            </div>-->\n            <h1 class=\"bkt-page__title\">Тарифы подписки</h1>\n            <div class=\"bkt-card bkt-card__body\">\n                <div class=\"bkt-form mx-auto w-100\">\n                    <div class=\"col-12\">\n                        <div class=\"bkt-wrapper-column bkt-gap\">\n                            <template v-if=\"!loading\">\n                                <template v-if=\"user_tariff\">\n                                    <div class=\"bkt-card bkt-tariffs__item active\">\n                                        <h4 class=\"bkt-card__title\">Текущий тариф</h4>\n                                        <div class=\"d-flex bkt-gap-small\">\n                                            <h4 class=\"bkt-card__text\">{{user_tariff.title}}</h4>\n                                            <div class=\"bkt-badge bkt-bg-green\">\n                                                Активен до {{user_tariff.expiredAt}}\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <hr class=\"w-100 m-0\">\n                                </template>\n                                <div v-for=\"(tariff, index) in available_tariffs\"\n                                     class=\"bkt-card__row outline bkt-tariffs__item\"\n                                     :class=\"{'current': choice==index}\" @click=\"chooseTariff(index)\"\n                                >\n                                    <bkt-checkbox v-if=\"!tariff.isUserTariff\" :name=\"'tariff_'+index\" type=\"radio\" v-model=\"choice\" :val=\"index\"\n                                                  wrapper_class=\"bkt-check_radio-check\"></bkt-checkbox>\n                                    <bkt-checkbox v-else :name=\"'tariff_'+index\" :value=\"true\" disabled\n                                                  wrapper_class=\"bkt-check_radio-check\"></bkt-checkbox>\n                                    <div class=\"bkt-wrapper-between w-100\">\n                                        <div\n                                            class=\"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini\">\n                                            <h4 class=\"bkt-card__text\">{{tariff.title}}</h4>\n                                            <div class=\"bkt-badge\" v-if=\"index>0 && !tariff.isUserTariff\">\n                                                Выгода {{getBenefit(tariff)}} %\n                                            </div>\n                                            <div class=\"bkt-badge\" v-if=\"tariff.isUserTariff\">Активен</div>\n                                        </div>\n                                        <h3 class=\"bkt-card__title\">{{tariff.price}} ₽\n                                            <span class=\"bkt-card__subtitle\"> / {{tariff.period}} дней</span>\n                                        </h3>\n                                    </div>\n                                </div>\n                            </template>\n                            <template v-if=\"loading\">\n                                <div v-for=\"n in 4\" class=\"bkt-card__row outline bkt-tariffs__item\">\n                                    <skeleton circle height=\"20px\" width=\"20px\"></skeleton>\n                                    <div class=\"bkt-wrapper-between w-100\">\n                                        <div\n                                            class=\"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini\">\n                                            <skeleton type_name=\"text\" heigth=\"16px\"></skeleton>\n                                            <skeleton skeleton_class=\"bkt-badge\" width=\"50px\"></skeleton>\n                                        </div>\n                                        <skeleton type_name=\"text\" heigth=\"26px\"></skeleton>\n                                    </div>\n                                </div>\n                            </template>\n                        </div>\n                    </div>\n                    <div class=\"col-12\">\n                        <div class=\"d-flex\">\n                            <button\n                                class=\"bkt-button primary bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0\"\n                                :disabled=\"tariff_loading\" v-if=\"!loading\" @click=\"buyTariff\"\n                            >\n                                <span v-show=\"tariff_loading\" class=\"spinner-border spinner-border-sm\" role=\"status\"></span>\n                                Купить\n                            </button>\n                            <skeleton v-if=\"loading\" type_name=\"button\"\n                                      skeleton_class=\"bkt-button bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0\"></skeleton>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"TariffPage\",\n        data() {\n            return {\n                choice: '0',\n                loading: false,\n                tariff_loading: false,\n            }\n        },\n        computed: {\n            tariffs() {\n                return this.$store.getters.tariffs\n            },\n            available_tariffs() {\n                return this.tariffs.filter(item => item.isUserTariff === false);\n            },\n            user_tariff() {\n                let index = this.tariffs.findIndex(item => item.isUserTariff === true);\n                if (index >= 0) {\n                    let tmp = this.tariffs[index];\n                    tmp.expiredAt = this.$moment(this.tariffs[index].expiredAt, 'DD.MM.YYYY HH:mm:ss').format('DD.MM.YYYY HH:mm')\n                    return tmp;\n                }\n                return null;\n            },\n            isLoggedIn() {\n                return this.$store.getters.isLoggedIn\n            }\n        },\n        mounted() {\n            if (this.tariffs.length === 0) {\n                this.getTariffs();\n            }\n        },\n        methods: {\n            async getTariffs() {\n                this.loading = true;\n                await this.$store.dispatch('getTariffs', {type:'bot_tariff'})\n                    .finally(() => {\n                        this.loading = false;\n                    })\n            },\n            getBenefit(tariff) {\n                let benefit = (100 - (tariff.price * 100 / (this.tariffs[0].price * (tariff.period / this.tariffs[0].period).toFixed())));\n                if (Number.isInteger(benefit)) {\n                    return benefit\n                } else {\n                    return benefit.toFixed(1)\n                }\n            },\n            buyTariff() {\n                if (this.isLoggedIn) {\n                    this.tariff_loading = true;\n                    axios.post('/api/payment', {tariffId: this.available_tariffs[this.choice].id})\n                        .then(resp => {\n                            this.tariff_loading = false;\n                            let redirect_url = resp.data.redirectUrl;\n                            let path = redirect_url.replace('pay-answer', 'bot/pay-answer');\n                            window.location.replace(path);\n                        })\n                        .catch(error => {\n                            this.tariff_loading = false;\n                            this.$store.dispatch('sendNotification',\n                                {self: this, type: 'error', message: 'Произошла ошибка, попробуйте позже'});\n                        })\n                }\n                else {\n                    // this.$store.commit('openModal', '#authModal')\n                }\n            },\n            chooseTariff(index) {\n                if (!this.available_tariffs[index].isUserTariff) {\n                    this.choice = index;\n                }\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TariffPage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5.use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TariffPage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./TariffPage.vue?vue&type=template&id=3bc13bf8&scoped=true\"\nimport script from \"./TariffPage.vue?vue&type=script&lang=js\"\nexport * from \"./TariffPage.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3bc13bf8\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"bkt-page bkt-container bkt-tariffs\"},[_c('h1',{staticClass:\"bkt-page__title\"},[_vm._v(\"Тарифы подписки\")]),_vm._v(\" \"),_c('div',{staticClass:\"bkt-card bkt-card__body\"},[_c('div',{staticClass:\"bkt-form mx-auto w-100\"},[_c('div',{staticClass:\"col-12\"},[_c('div',{staticClass:\"bkt-wrapper-column bkt-gap\"},[(!_vm.loading)?[(_vm.user_tariff)?[_c('div',{staticClass:\"bkt-card bkt-tariffs__item active\"},[_c('h4',{staticClass:\"bkt-card__title\"},[_vm._v(\"Текущий тариф\")]),_vm._v(\" \"),_c('div',{staticClass:\"d-flex bkt-gap-small\"},[_c('h4',{staticClass:\"bkt-card__text\"},[_vm._v(_vm._s(_vm.user_tariff.title))]),_vm._v(\" \"),_c('div',{staticClass:\"bkt-badge bkt-bg-green\"},[_vm._v(\"\\n                                                Активен до \"+_vm._s(_vm.user_tariff.expiredAt)+\"\\n                                            \")])])]),_vm._v(\" \"),_c('hr',{staticClass:\"w-100 m-0\"})]:_vm._e(),_vm._v(\" \"),_vm._l((_vm.available_tariffs),function(tariff,index){return _c('div',{staticClass:\"bkt-card__row outline bkt-tariffs__item\",class:{'current': _vm.choice==index},on:{\"click\":function($event){return _vm.chooseTariff(index)}}},[(!tariff.isUserTariff)?_c('bkt-checkbox',{attrs:{\"name\":'tariff_'+index,\"type\":\"radio\",\"val\":index,\"wrapper_class\":\"bkt-check_radio-check\"},model:{value:(_vm.choice),callback:function ($$v) {_vm.choice=$$v},expression:\"choice\"}}):_c('bkt-checkbox',{attrs:{\"name\":'tariff_'+index,\"value\":true,\"disabled\":\"\",\"wrapper_class\":\"bkt-check_radio-check\"}}),_vm._v(\" \"),_c('div',{staticClass:\"bkt-wrapper-between w-100\"},[_c('div',{staticClass:\"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini\"},[_c('h4',{staticClass:\"bkt-card__text\"},[_vm._v(_vm._s(tariff.title))]),_vm._v(\" \"),(index>0 && !tariff.isUserTariff)?_c('div',{staticClass:\"bkt-badge\"},[_vm._v(\"\\n                                                Выгода \"+_vm._s(_vm.getBenefit(tariff))+\" %\\n                                            \")]):_vm._e(),_vm._v(\" \"),(tariff.isUserTariff)?_c('div',{staticClass:\"bkt-badge\"},[_vm._v(\"Активен\")]):_vm._e()]),_vm._v(\" \"),_c('h3',{staticClass:\"bkt-card__title\"},[_vm._v(_vm._s(tariff.price)+\" ₽\\n                                            \"),_c('span',{staticClass:\"bkt-card__subtitle\"},[_vm._v(\" / \"+_vm._s(tariff.period)+\" дней\")])])])],1)})]:_vm._e(),_vm._v(\" \"),(_vm.loading)?_vm._l((4),function(n){return _c('div',{staticClass:\"bkt-card__row outline bkt-tariffs__item\"},[_c('skeleton',{attrs:{\"circle\":\"\",\"height\":\"20px\",\"width\":\"20px\"}}),_vm._v(\" \"),_c('div',{staticClass:\"bkt-wrapper-between w-100\"},[_c('div',{staticClass:\"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini\"},[_c('skeleton',{attrs:{\"type_name\":\"text\",\"heigth\":\"16px\"}}),_vm._v(\" \"),_c('skeleton',{attrs:{\"skeleton_class\":\"bkt-badge\",\"width\":\"50px\"}})],1),_vm._v(\" \"),_c('skeleton',{attrs:{\"type_name\":\"text\",\"heigth\":\"26px\"}})],1)],1)}):_vm._e()],2)]),_vm._v(\" \"),_c('div',{staticClass:\"col-12\"},[_c('div',{staticClass:\"d-flex\"},[(!_vm.loading)?_c('button',{staticClass:\"bkt-button primary bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0\",attrs:{\"disabled\":_vm.tariff_loading},on:{\"click\":_vm.buyTariff}},[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.tariff_loading),expression:\"tariff_loading\"}],staticClass:\"spinner-border spinner-border-sm\",attrs:{\"role\":\"status\"}}),_vm._v(\"\\n                                Купить\\n                            \")]):_vm._e(),_vm._v(\" \"),(_vm.loading)?_c('skeleton',{attrs:{\"type_name\":\"button\",\"skeleton_class\":\"bkt-button bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0\"}}):_vm._e()],1)])])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"names":["name","data","choice","loading","tariff_loading","computed","tariffs","available_tariffs","user_tariff","tmp","isLoggedIn","mounted","methods","getTariffs","_this","_context","type","getBenefit","buyTariff","axios","tariffId","then","_this2","window","self","message","chooseTariff","_vm","this","_c","_self","staticClass","_v","_e","_s","title","expiredAt","_l","tariff","index","class","on","$event","isUserTariff","attrs","model","value","callback","$$v","expression","price","period","n","directives","rawName"],"sourceRoot":""}