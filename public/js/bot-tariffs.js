/*! For license information please see bot-tariffs.js.LICENSE.txt */
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8240],{48551:(t,e,r)=>{r.r(e),r.d(e,{default:()=>p});function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function i(){var t=u(),e=t.m(i),r=(Object.getPrototypeOf?Object.getPrototypeOf(e):e.__proto__).constructor;function n(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===r||"GeneratorFunction"===(e.displayName||e.name))}var l={throw:1,return:2,break:3,continue:3};function _(t){var e,r;return function(n){e||(e={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(t,e){return r(n.a,l[t],e)},delegateYield:function(t,i,o){return e.resultName=i,r(n.d,a(t),o)},finish:function(t){return r(n.f,t)}},r=function(t,r,i){n.p=e.prev,n.n=e.next;try{return t(r,i)}finally{e.next=n.n}}),e.resultName&&(e[e.resultName]=n.v,e.resultName=void 0),e.sent=n.v,e.next=n.n;try{return t.call(this,e)}finally{n.p=e.prev,n.n=e.next}}}return(i=function(){return{wrap:function(e,r,n,i){return t.w(_(e),r,n,i&&i.reverse())},isGeneratorFunction:n,mark:t.m,awrap:function(t,e){return new d(t,e)},AsyncIterator:f,async:function(t,e,r,i,a){return(n(e)?c:s)(_(t),e,r,i,a)},keys:o,values:a}})()}function a(t){if(null!=t){var e=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(n(t)+" is not iterable")}function o(t){var e=Object(t),r=[];for(var n in e)r.unshift(n);return function t(){for(;r.length;)if((n=r.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}}function s(t,e,r,n,i){var a=c(t,e,r,n,i);return a.next().then((function(t){return t.done?t.value:a.next()}))}function c(t,e,r,n,i){return new f(u().w(t,e,r,n),i||Promise)}function f(t,e){function r(n,i,a,o){try{var s=t[n](i),c=s.value;return c instanceof d?e.resolve(c.v).then((function(t){r("next",t,a,o)}),(function(t){r("throw",t,a,o)})):e.resolve(c).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,o)}))}catch(t){o(t)}}var n;this.next||(l(f.prototype),l(f.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),l(this,"_invoke",(function(t,i,a){function o(){return new e((function(e,n){r(t,a,e,n)}))}return n=n?n.then(o,o):o()}),!0)}function u(){var t,e,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function a(r,n,i,a){var c=n&&n.prototype instanceof s?n:s,f=Object.create(c.prototype);return l(f,"_invoke",function(r,n,i){var a,s,c,f=0,u=i||[],l=!1,d={p:0,n:0,v:t,a:_,f:_.bind(t,4),d:function(e,r){return a=e,s=0,c=t,d.n=r,o}};function _(r,n){for(s=r,c=n,e=0;!l&&f&&!i&&e<u.length;e++){var i,a=u[e],_=d.p,b=a[2];r>3?(i=b===n)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=t):a[0]<=_&&((i=r<2&&_<a[1])?(s=0,d.v=n,d.n=a[1]):_<b&&(i=r<3||a[0]>n||n>b)&&(a[4]=r,a[5]=n,d.n=b,s=0))}if(i||r>1)return o;throw l=!0,n}return function(i,u,b){if(f>1)throw TypeError("Generator is already running");for(l&&1===u&&_(u,b),s=u,c=b;(e=s<2?t:c)||!l;){a||(s?s<3?(s>1&&(d.n=-1),_(s,c)):d.n=c:d.v=c);try{if(f=2,a){if(s||(i="next"),e=a[i]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,s<2&&(s=0)}else 1===s&&(e=a.return)&&e.call(a),s<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),s=1);a=t}else if((e=(l=d.n<0)?c:r.call(n,d))!==o)break}catch(e){a=t,s=1,c=e}finally{f=1}}return{value:e,done:l}}}(r,i,a),!0),f}var o={};function s(){}function c(){}function f(){}e=Object.getPrototypeOf;var d=[][n]?e(e([][n]())):(l(e={},n,(function(){return this})),e),_=f.prototype=s.prototype=Object.create(d);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,l(t,i,"GeneratorFunction")),t.prototype=Object.create(_),t}return c.prototype=f,l(_,"constructor",f),l(f,"constructor",c),c.displayName="GeneratorFunction",l(f,i,"GeneratorFunction"),l(_),l(_,i,"Generator"),l(_,n,(function(){return this})),l(_,"toString",(function(){return"[object Generator]"})),(u=function(){return{w:a,m:b}})()}function l(t,e,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}l=function(t,e,r,n){function a(e,r){l(t,e,(function(t){return this._invoke(e,r,t)}))}e?i?i(t,e,{value:r,enumerable:!n,configurable:!n,writable:!n}):t[e]=r:(a("next",0),a("throw",1),a("return",2))},l(t,e,r,n)}function d(t,e){this.v=t,this.k=e}function _(t,e,r,n,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,i)}const b={name:"TariffPage",data:function(){return{choice:"0",loading:!1,tariff_loading:!1}},computed:{tariffs:function(){return this.$store.getters.tariffs},available_tariffs:function(){return this.tariffs.filter((function(t){return!1===t.isUserTariff}))},user_tariff:function(){var t=this.tariffs.findIndex((function(t){return!0===t.isUserTariff}));if(t>=0){var e=this.tariffs[t];return e.expiredAt=this.$moment(this.tariffs[t].expiredAt,"DD.MM.YYYY HH:mm:ss").format("DD.MM.YYYY HH:mm"),e}return null},isLoggedIn:function(){return this.$store.getters.isLoggedIn},auth_user:function(){return this.$store.getters.auth_user},auth_user_loading:function(){return this.$store.getters.auth_user_loading}},mounted:function(){0===this.tariffs.length&&this.getTariffs()},methods:{getTariffs:function(){var t,e=this;return(t=i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$store.dispatch("getTariffs",{type:"bot_tariff"}).then((function(t){e.loading=!1})).catch((function(t){e.loading=!1}));case 3:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function o(t){_(a,n,i,o,s,"next",t)}function s(t){_(a,n,i,o,s,"throw",t)}o(void 0)}))})()},getBenefit:function(t){var e=100-100*t.price/(this.tariffs[0].price*(t.period/this.tariffs[0].period).toFixed());return Number.isInteger(e)?e:e.toFixed(1)},buyTariff:function(){var t=this;this.isLoggedIn&&(this.tariff_loading=!0,axios.post("/api/payment",{tariffId:this.available_tariffs[this.choice].id}).then((function(e){t.tariff_loading=!1;var r=e.data.redirectUrl.replace("pay-answer","bot/pay-answer");window.location.replace(r)})).catch((function(e){t.tariff_loading=!1,t.$store.dispatch("sendNotification",{self:t,type:"error",message:"Произошла ошибка, попробуйте позже"})})))},chooseTariff:function(t){this.available_tariffs[t].isUserTariff||(this.choice=t)}}};const p=(0,r(14486).A)(b,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"bkt-page bkt-container bkt-tariffs"},[t.loading||t.auth_user_loading||t.isLoggedIn&&t.auth_user&&t.auth_user.botTariff?t._e():e("div",{staticClass:"bkt-shadow-card bkt-shadow-card_primary mt-3 mb-4"},[t._m(0)]),t._v(" "),e("h1",{staticClass:"bkt-page__title"},[t._v("Тарифы подписки")]),t._v(" "),e("div",{staticClass:"bkt-card bkt-card__body"},[e("div",{staticClass:"bkt-form mx-auto w-100"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"bkt-wrapper-column bkt-gap"},[t.loading?t._e():[t.user_tariff?[e("div",{staticClass:"bkt-card bkt-tariffs__item active"},[e("h4",{staticClass:"bkt-card__title"},[t._v("Текущий тариф")]),t._v(" "),e("div",{staticClass:"d-flex bkt-gap-small"},[e("h4",{staticClass:"bkt-card__text"},[t._v(t._s(t.user_tariff.title))]),t._v(" "),e("div",{staticClass:"bkt-badge bkt-bg-green"},[t._v("\n                                            Активен до "+t._s(t.user_tariff.expiredAt)+"\n                                        ")])])]),t._v(" "),e("hr",{staticClass:"w-100 m-0"})]:t._e(),t._v(" "),t._l(t.available_tariffs,(function(r,n){return e("div",{staticClass:"bkt-card__row outline bkt-tariffs__item",class:{current:t.choice==n},on:{click:function(e){return t.chooseTariff(n)}}},[r.isUserTariff?e("bkt-checkbox",{attrs:{name:"tariff_"+n,value:!0,disabled:"",wrapper_class:"bkt-check_radio-check"}}):e("bkt-checkbox",{attrs:{name:"tariff_"+n,type:"radio",val:n,wrapper_class:"bkt-check_radio-check"},model:{value:t.choice,callback:function(e){t.choice=e},expression:"choice"}}),t._v(" "),e("div",{staticClass:"bkt-wrapper-between w-100"},[e("div",{staticClass:"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini"},[e("h4",{staticClass:"bkt-card__text"},[t._v(t._s(r.title))]),t._v(" "),n>0&&!r.isUserTariff?e("div",{staticClass:"bkt-badge"},[t._v("\n                                            Выгода "+t._s(t.getBenefit(r))+" %\n                                        ")]):t._e(),t._v(" "),r.isUserTariff?e("div",{staticClass:"bkt-badge"},[t._v("Активен")]):t._e()]),t._v(" "),e("h3",{staticClass:"bkt-card__title"},[t._v(t._s(r.price)+" ₽\n                                        "),e("span",{staticClass:"bkt-card__subtitle"},[t._v(" / "+t._s(r.period)+" дней")])])])],1)}))],t._v(" "),t.loading?t._l(4,(function(r){return e("div",{staticClass:"bkt-card__row outline bkt-tariffs__item"},[e("skeleton",{attrs:{circle:"",height:"20px",width:"20px"}}),t._v(" "),e("div",{staticClass:"bkt-wrapper-between w-100"},[e("div",{staticClass:"bkt-wrapper-down-sm-between bkt-gap-down-sm-column bkt-w-down-sm-100 bkt-gap-row-mini"},[e("skeleton",{attrs:{type_name:"text",heigth:"16px"}}),t._v(" "),e("skeleton",{attrs:{skeleton_class:"bkt-badge",width:"50px"}})],1),t._v(" "),e("skeleton",{attrs:{type_name:"text",heigth:"26px"}})],1)],1)})):t._e()],2)]),t._v(" "),e("div",{staticClass:"col-12"},[e("div",{staticClass:"d-flex"},[t.loading?t._e():e("button",{staticClass:"bkt-button primary bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0",attrs:{disabled:t.tariff_loading},on:{click:t.buyTariff}},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.tariff_loading,expression:"tariff_loading"}],staticClass:"spinner-border spinner-border-sm",attrs:{role:"status"}}),t._v("\n                            Купить\n                        ")]),t._v(" "),t.loading?e("skeleton",{attrs:{type_name:"button",skeleton_class:"bkt-button bkt-tariffs__button bkt-w-down-sm-100 mx-auto ms-lg-auto me-lg-0"}}):t._e()],1)])])])])])}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"bkt-shadow-card__inner bkt-gap-large"},[e("h4",{staticClass:"bkt-shadow-card__title bkt-text-white"},[t._v("\n                    Пробный период закончился"),e("br"),t._v(" "),e("span",[t._v("Купите подписку, чтобы продолжить просмотр лотов")])]),t._v(" "),e("div",{staticClass:"bkt-shadow-card__shadow-1"}),t._v(" "),e("div",{staticClass:"bkt-shadow-card__shadow-2"})])}],!1,null,"fb4cb604",null).exports}}]);
//# sourceMappingURL=bot-tariffs.js.map